{% extends 'base.html' %}

{% block title %}Meu Painel de Laudos{% endblock %}

{% block content %}
<div class="container">
    <h1 class="mb-4">Meu Painel - {{ user.get_full_name }}</h1>

    <div class="row">
        <!-- Card de Informações Pessoais -->
        <div class="col-md-4">
            <div class="card mb-4">
                <div class="card-header">
                    <i class="fas fa-user-circle"></i> Minhas Informações
                </div>
                <div class="card-body">
                    <p><strong>Nome:</strong> {{ user.get_full_name }}</p>
                    <p><strong>Email:</strong> {{ user.email }}</p>
                    {% if medico_responsavel %}
                        <p><strong>Médico Responsável:</strong> Dr(a). {{ medico_responsavel.user.get_full_name }}</p>
                        <p><strong>CRM:</strong> {{ medico_responsavel.crm }}</p>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Card da Lista de Laudos -->
        <div class="col-md-8">
            <div class="card mb-4">
                <div class="card-header">
                    <i class="fas fa-file-medical-alt"></i> Histórico de Laudos
                </div>
                <div class="card-body">
                    {% if meus_laudos %}
                        <ul class="list-group list-group-flush">
                            {% for laudo in meus_laudos %}
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    <div>
                                        <strong>Data da Análise:</strong> {{ laudo.data_laudo|date:"d/m/Y" }} <br>
                                        <small class="text-muted">ID do Laudo: #{{ laudo.pk }}</small>
                                    </div>
                                    <div>
                                        {% if laudo.resultado_classificacao and laudo.resultado_classificacao != 'Indeterminado' %}
                                            <span class="badge bg-success me-2">Resultado Disponível</span>
                                            <a href="{% url 'laudo_detail' laudo.pk %}" class="btn btn-primary btn-sm">Ver Laudo</a>
                                        {% else %}
                                            <span class="badge bg-secondary">Em Análise</span>
                                        {% endif %}
                                    </div>
                                </li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        <p class="text-center text-muted">Você ainda não possui nenhum laudo registrado.</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}